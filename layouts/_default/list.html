{{ define "main" }}
<article>
  <header class="content">
    <h1>{{ .Title }}</h1>
    <p>{{ .Description }}</p>
  </header>
  <main class="content">
    {{ .Content }}

    {{ $all_pages := .Pages }}
    {{ range $category := where $.Site.Data.categories "type" .Type }}
    {{ with $pages := where $all_pages ".Params.category" $category.name }}
    <h2 id="{{ $category.name }}">{{ humanize $category.name | title }}</h2>
    <ul>
      {{ range ($pages.ByDate.ByParam "rating").Reverse }}
      {{ .Render "li" }}
      {{ end }}
    </ul>
    {{ end }}
    {{ end }}
  </main>
</article>
{{ end }}
